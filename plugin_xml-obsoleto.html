<head>
<script>scr="https://cdnjs.cloudflare.com/ajax/libs/jszip/2.4.0/jszip.min.js"</script>
</head>
<title>File API</title>
<style>
#holder { border: 10px dashed #ccc; width: 300px; height: 300px; margin: 20px auto;}
#holder.hover { border: 10px dashed #333; }
</style>
<article>
  <div id="holder"></div> 
  <p id="status"></p>  
<textarea rows="20" cols="100" id="contenedor"></textarea>


</article>

<script>


var holder = document.getElementById('holder'),
    state = document.getElementById('status');
if (typeof window.FileReader === 'undefined') {
  state.className = 'fail';
} else {
  state.className = 'success';
  state.innerHTML = 'Arrastra un ODT';
}
 
holder.ondragover = function () { this.className = 'hover'; return false; };
holder.ondragend = function () { this.className = ''; return false; };
holder.ondrop = function (e) {
  this.className = '';
  e.preventDefault();
  
		var file = e.dataTransfer.files[0]; 
		reader = new FileReader();	

		reader.onload = function(e) {			
			console.log(file);
			var ficheroArrastrado = reader.result;			
		}

		
		reader.readAsArrayBuffer(file); 
	
	
		var zip = new JSZip();		 
		zip.loadAsync(ficheroArrastrado);				 
	
		zip.file("content.xml").async("string").then(function (data) {
			console.log(data);
		});

	
	
		
		
		 /*
		if (typeof someObject == 'undefined') $.loadScript('https://cdnjs.cloudflare.com/ajax/libs/jszip/2.4.0/jszip.min.js', function () {
			
            var req = new XMLHttpRequest();
			
		
			// abrimos el fichero 
            req.open('GET','https://isaacmarco.github.io/odt/' + nombreFicheroContenedor + '.odt'); 			 
            req.responseType = 'arraybuffer';
            
			req.addEventListener('load', function () {				
					
				
				// fichero de la plantilla descargada
				var ficheroContenedor = req.response;          
				// 	obtenemos un content y un styles xml vacios desde el fichero 
				var odtdoc = new ODTContent(ficheroContenedor);
								
				// volcamos todo el XML de la vista formidable en el content.xml 				
				odtdoc.setXML(xml_content, xml_styles_plantilla);
								 
				
				// obtenemos el ODT ya comprimido
				var odt = odtdoc.getODT();	
				// pasamos el odt a largue binary object
				var blob = b64toBlob(odt, "application/vnd.oasis.opendocument.text");				
				// creamos el link de descarga
				CrearLinkDescarga(blob);
				
            });			
			
            req.send();
            $.loadScript('http://www3.gobiernodecanarias.org/medusa/contenidosdigitales/js/jszip/dist/jszip.min.js');
        });*/
		 

  return false;
};
</script>